import requests
import time

headers = {
    "User-Agent": "Mozilla/5.0",
    "X-Requested-With": "XMLHttpRequest"
}

with open("ghdb_dorks_only.txt", "w", encoding="utf-8") as file:
    for offset in range(0, 8000, 20):  # ~7944 entries
        print(f"Fetching offset {offset}")
        url = f"https://www.exploit-db.com/search?ajax=true&order_by=date_published&order=desc&offset={offset}&q=&type=ghdb"
        try:
            response = requests.get(url, headers=headers)
            data = response.json()
            for row in data["data"]:
                dork = row["description"].strip()
                file.write(dork + "\n")
        except Exception as e:
            print(f"Error at offset {offset}: {e}")
        time.sleep(1)
